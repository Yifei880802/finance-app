<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart.js é—®é¢˜è°ƒè¯•</title>
    <style>
        body {
            font-family: system-ui;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        .section {
            background: #2a2a2a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .error { color: #ff6b6b; }
        .success { color: #51cf66; }
        .warning { color: #ffd43b; }
        pre {
            background: #333;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Chart.js åŠ è½½é—®é¢˜è°ƒè¯•</h1>
    
    <div class="section">
        <h3>å®æ—¶æ£€æµ‹çŠ¶æ€</h3>
        <div id="status">æ£€æµ‹ä¸­...</div>
    </div>
    
    <div class="section">
        <h3>è°ƒè¯•ä¿¡æ¯</h3>
        <pre id="debug-info">ç­‰å¾…æ£€æµ‹...</pre>
    </div>
    
    <div class="section">
        <h3>æ¨¡æ‹Ÿé”™è¯¯</h3>
        <button onclick="simulateError()">æ¨¡æ‹Ÿç”¨æˆ·çœ‹åˆ°çš„é”™è¯¯</button>
        <div id="error-output"></div>
    </div>

    <script>
        let debugInfo = [];
        
        function addDebug(message) {
            debugInfo.push(`[${new Date().toLocaleTimeString()}] ${message}`);
            document.getElementById('debug-info').textContent = debugInfo.join('\n');
        }
        
        function updateStatus(message, className = '') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = className;
        }
        
        function simulateError() {
            // æ¨¡æ‹Ÿä½ æä¾›çš„é”™è¯¯è¾“å‡º
            const errorArray = ["âš ï¸ Chart.js åº“æœªåŠ è½½ï¼"];
            console.log(errorArray);
            
            document.getElementById('error-output').innerHTML = `
                <pre class="error">æ¨¡æ‹Ÿçš„ç”¨æˆ·é”™è¯¯è¾“å‡ºï¼š
Array(1)
0: "âš ï¸ Chart.js åº“æœªåŠ è½½ï¼"
length: 1</pre>
            `;
        }
        
        function detectChartJs() {
            addDebug('å¼€å§‹æ£€æµ‹Chart.js...');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰Chartå¯¹è±¡
            if (typeof Chart === 'undefined') {
                addDebug('âŒ Chart å¯¹è±¡æœªå®šä¹‰');
                updateStatus('âŒ Chart.js å®Œå…¨æœªåŠ è½½', 'error');
                return false;
            }
            
            // æ£€æŸ¥Chartå¯¹è±¡çš„å±æ€§
            addDebug('âœ… Chart å¯¹è±¡å­˜åœ¨');
            addDebug(`Chart ç±»å‹: ${typeof Chart}`);
            
            if (Chart.version) {
                addDebug(`âœ… Chart.js ç‰ˆæœ¬: ${Chart.version}`);
                updateStatus(`âœ… Chart.js æ­£å¸¸ (${Chart.version})`, 'success');
                return true;
            } else {
                addDebug('âš ï¸ Chart.version ä¸å­˜åœ¨');
                updateStatus('âš ï¸ Chart.js åŠ è½½ä¸å®Œæ•´', 'warning');
                return false;
            }
        }
        
        // å°è¯•å¤šç§æ–¹å¼åŠ è½½Chart.js
        addDebug('ğŸš€ å¼€å§‹åŠ è½½æµ‹è¯•...');
        
        // æ–¹æ³•1ï¼šç›´æ¥å°è¯•åŠ è½½ Chart.js 4.4.1
        const script1 = document.createElement('script');
        script1.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js';
        script1.onload = () => {
            addDebug('âœ… JSDelivr CDN åŠ è½½æˆåŠŸ');
            detectChartJs();
        };
        script1.onerror = () => {
            addDebug('âŒ JSDelivr CDN åŠ è½½å¤±è´¥ï¼Œå°è¯•å…¶ä»–CDN...');
            
            // æ–¹æ³•2ï¼šå°è¯• CDNJS
            const script2 = document.createElement('script');
            script2.src = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js';
            script2.onload = () => {
                addDebug('âœ… CDNJS CDN åŠ è½½æˆåŠŸ');
                detectChartJs();
            };
            script2.onerror = () => {
                addDebug('âŒ CDNJS CDN ä¹Ÿå¤±è´¥ï¼Œå°è¯• unpkg...');
                
                // æ–¹æ³•3ï¼šå°è¯• unpkg
                const script3 = document.createElement('script');
                script3.src = 'https://unpkg.com/chart.js@4.4.1/dist/chart.umd.js';
                script3.onload = () => {
                    addDebug('âœ… unpkg CDN åŠ è½½æˆåŠŸ');
                    detectChartJs();
                };
                script3.onerror = () => {
                    addDebug('âŒ æ‰€æœ‰ CDN éƒ½å¤±è´¥äº†ï¼');
                    updateStatus('âŒ ç½‘ç»œè¿æ¥é—®é¢˜æˆ–æ‰€æœ‰CDNä¸å¯ç”¨', 'error');
                    
                    // æ¨¡æ‹Ÿç”¨æˆ·çœ‹åˆ°çš„é”™è¯¯
                    setTimeout(() => {
                        const errorMsg = "âš ï¸ Chart.js åº“æœªåŠ è½½ï¼";
                        console.log([errorMsg]); // è¿™ä¼šäº§ç”Ÿç”¨æˆ·çœ‹åˆ°çš„Arrayè¾“å‡º
                        addDebug(`ğŸ” è¿™ä¼šäº§ç”Ÿç”¨æˆ·çœ‹åˆ°çš„é”™è¯¯: [${errorMsg}]`);
                    }, 1000);
                };
                document.head.appendChild(script3);
            };
            document.head.appendChild(script2);
        };
        
        document.head.appendChild(script1);
        
        // 5ç§’åè¿›è¡Œæœ€ç»ˆæ£€æµ‹
        setTimeout(() => {
            addDebug('â° 5ç§’è¶…æ—¶æ£€æµ‹...');
            const finalResult = detectChartJs();
            if (!finalResult) {
                addDebug('ğŸ”„ æœ€ç»ˆæ£€æµ‹ï¼šChart.js åŠ è½½å¤±è´¥');
                updateStatus('ğŸ”„ 5ç§’åä»æœªæˆåŠŸåŠ è½½Chart.js', 'error');
            }
        }, 5000);
    </script>
</body>
</html>